<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Sign Up - Warwick SU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- 全站样式 / 登录态工具 -->
  <link rel="stylesheet" href="static/assets/css/style.css">
  <script src="static/assets/js/auth-mock.js" defer></script>

  <style>
    .auth-wrap{min-height:calc(100vh - var(--nav-h,72px));display:grid;place-items:center;padding:36px 16px;}
    .auth-card{width:min(560px,92vw);background:#fff;border:1px solid #E5E7EB;border-radius:16px;box-shadow:0 14px 40px rgba(0,0,0,.08);padding:26px;}
    .auth-head{text-align:center;margin-bottom:18px;}
    .auth-head h1{margin:.2rem 0;font-size:24px;}
    .auth-head p{color:#6B7280;margin:0;}
    .field{display:grid;gap:6px;margin:12px 0;}
    .field label{font-weight:600;}
    .input{width:100%;padding:.65rem .8rem;border:1px solid #E5E7EB;border-radius:12px;font:inherit;}
    .input:focus{outline:2px solid #C676FF22;border-color:#C676FF;}
    .field-row{display:grid;gap:12px;grid-template-columns:1fr 1fr;}
    @media (max-width:640px){.field-row{grid-template-columns:1fr;}}
    .pw-row{position:relative;}
    .pw-toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);border:1px solid #E5E7EB;background:#fff;border-radius:10px;padding:4px 8px;cursor:pointer;}
    .row-between{display:flex;justify-content:space-between;align-items:center;gap:10px;}
    .checkbox{display:flex;align-items:center;gap:8px;color:#374151;}
    .btn{display:inline-block;padding:.7rem 1rem;border-radius:12px;border:1px solid #E5E7EB;background:#fff;text-decoration:none;color:#111;font-weight:600;}
    .btn--primary{background:var(--primary,#C676FF);border-color:var(--primary,#C676FF);color:#111;width:100%;}
    .btn--primary:hover{filter:brightness(.96);}
    .muted{color:#6B7280;}
    .auth-footer{text-align:center;margin-top:14px;color:#6B7280;}
    .auth-footer a{text-decoration:none;color:#6B21A8;}
    .error{display:none;margin-top:10px;padding:10px 12px;border:1px solid #FCA5A5;border-radius:10px;background:#FEE2E2;color:#991B1B;font-size:14px;}
    .ok{display:none;margin-top:10px;padding:10px 12px;border:1px solid #BBF7D0;border-radius:10px;background:#ECFDF5;color:#065F46;font-size:14px;}
  </style>
</head>
<body>
  <!-- 顶部导航 -->
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="/">
        <img src="static/images/warwick-logo.png" alt="Warwick" width="160">
      </a>
      <nav class="nav-center">
        <a href="/" class="nav-link">Home</a>
        <a href="/rooms" class="nav-link">Room</a>
        <a href="/schedule" class="nav-link">Schedule</a>
        <a href="/bookings" class="nav-link">My Booking</a>
        <a href="/admin" class="nav-link" data-role="admin" style="display:none;">Admin</a>

      </nav>
      <nav class="nav-right">
        <!-- 未登录可见 -->
        <a href="/login" class="nav-link" data-auth="guest">Login</a>
        <a href="/register" class="nav-link" data-auth="guest">Sign Up</a>
        <!-- 登录后可见 -->
        <span class="nav-link" id="navUser" data-auth="user" style="pointer-events:none;"></span>
        <a href="#" class="nav-link" id="logoutBtn" data-auth="user">Logout</a>
      </nav>
    </div>
  </header>

  <!-- 注册主体 -->
  <main class="auth-wrap">
    <form class="auth-card" id="registerForm" method="post" action="#">
      <div class="auth-head">
        <h1>Create your account</h1>
        <p class="muted">Join to book and manage society rooms</p>
      </div>

      <div class="field">
        <label for="name">Full name</label>
        <input class="input" type="text" id="name" name="name" placeholder="Your name" required>
      </div>

      <div class="field">
        <label for="email">Warwick email</label>
        <input class="input" type="email" id="email" name="email" placeholder="you@warwick.ac.uk" required>
      </div>

      <div class="field-row">
        <div class="field">
          <label for="password">Password</label>
          <div class="pw-row">
            <input class="input" type="password" id="password" name="password" placeholder="Min 6 characters" required minlength="6">
            <button class="pw-toggle" type="button" data-target="#password">Show</button>
          </div>
        </div>
        <div class="field">
          <label for="confirm">Confirm password</label>
          <div class="pw-row">
            <input class="input" type="password" id="confirm" name="confirm" placeholder="Re-enter password" required minlength="6">
            <button class="pw-toggle" type="button" data-target="#confirm">Show</button>
          </div>
        </div>
      </div>

      <div class="field">
        <label for="role">Role (for demo)</label>
        <select class="input" id="role" name="role" required>
          <option value="">Select a role…</option>
          <option value="member">Member</option>
          <option value="exec">Exec (can book)</option>
        </select>
      </div>

      <label class="checkbox" style="margin-top:6px;">
        <input type="checkbox" id="tos" required> I agree to the <a href="#" style="margin-left:6px;">Terms</a>
      </label>

      <div class="error" id="errBox"></div>
      <div class="ok" id="okBox">Account created! Redirecting to login…</div>

      <button class="btn btn--primary" type="submit">Create account</button>

      <div class="auth-footer">
        Already have an account? <a href="/login">Login</a>
      </div>
    </form>
  </main>

  <footer class="container" style="text-align:center;margin:20px auto 40px;">
    <small>© 2025 University of Warwick (demo)</small>
  </footer>

  <!-- 轻量 JS：显示/隐藏密码 + 简单前端校验 + 演示跳转 -->
  <script>
    (function(){
      // 显示/隐藏密码
      document.querySelectorAll('.pw-toggle').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const target = document.querySelector(btn.dataset.target);
          if(!target) return;
          if(target.type === 'password'){ target.type = 'text'; btn.textContent = 'Hide'; }
          else{ target.type = 'password'; btn.textContent = 'Show'; }
        });
      });

      // 简单前端校验（演示用）
      const form = document.getElementById('registerForm');
      const err  = document.getElementById('errBox');
      const ok   = document.getElementById('okBox');

      form.addEventListener('submit', (e)=>{
        e.preventDefault(); // 演示：不真正提交后端
        err.style.display = 'none';
        ok.style.display  = 'none';

        const name  = form.name.value.trim();
        const email = form.email.value.trim();
        const pwd   = form.password.value;
        const cfm   = form.confirm.value;
        const role  = form.role.value;

        const emailOK = /@warwick\.ac\.uk$/i.test(email);

        if(!emailOK) return showErr('Please use your @warwick.ac.uk email.');
        if(pwd.length < 6) return showErr('Password must be at least 6 characters.');
        if(pwd !== cfm)    return showErr('Passwords do not match.');
        if(!role)          return showErr('Please select a role.');
        if(!document.getElementById('tos').checked) return showErr('You must agree to the Terms.');

        // 通过（演示）：显示成功→跳转登录
        ok.style.display = 'block';
        setTimeout(()=>{ window.location.href = '/login'; }, 900);
      });

      function showErr(msg){
        err.textContent = msg;
        err.style.display = 'block';
      }
    })();
  </script>
</body>
</html>